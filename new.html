<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tierney's Math Games</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 2rem;
    }
    .grid {
      display: grid;
      gap: 0px;
      margin: 1rem auto;
      justify-content: center;
    }
    .cell {
      width: 80px;
      height: 80px;
      border: 2px solid #ccc;
      background-color: white;
    }
    .block {
      width: 80px;
      height: 80px;
      margin-bottom: 10px;
      cursor: grab;
    }
.grid {
  display: grid;
  gap: 0px;
  margin: 1rem auto;
  justify-content: center;
  background-color: white;
}
.cell {
  width: 80px;
  height: 80px;
  border: 2px solid black; /* make the grid lines black */
  background-color: white; /* keep cell background white */
}
    .blue { background-color: lightblue; }
    .green { background-color: lightgreen; }
    .piles {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }
    .pile {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .row-block {
      display: flex;
      flex-direction: row;
    }
    .row-block .block {
      margin-bottom: 0;
      margin-right: 2px;
    }
    .equation {
      font-size: 2rem;
      margin-top: 1rem;
    }
    input.answer {
      width: 50px;
      font-size: 2rem;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>Tierney's Math Games</h1>
  <div>
    <button id="make5Btn">Play Make 5</button>
    <button id="make10Btn">Play Make 10</button>
  </div>
  <div class="grid" id="grid"></div>
  <div class="piles" id="piles"></div>
  <div class="equation" id="equation"></div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const grid = document.getElementById('grid');
      const piles = document.getElementById('piles');
      const equation = document.getElementById('equation');
      const make5Btn = document.getElementById('make5Btn');
      const make10Btn = document.getElementById('make10Btn');

      let totalCells = 5;
      let rows = 1;
      let filledCells = 0;

      function createBlock(color) {
        const block = document.createElement('div');
        block.className = `block ${color}`;
        block.draggable = true;
        block.addEventListener('dragstart', (e) => {
          e.dataTransfer.setData('text/plain', color);
        });
        return block;
      }

      function createRowBlock() {
        const row = document.createElement('div');
        row.className = 'row-block';
        row.draggable = true;
        for (let i = 0; i < 5; i++) {
          const b = createBlock('green');
          b.draggable = false;
          row.appendChild(b);
        }
        row.addEventListener('dragstart', (e) => {
          e.dataTransfer.setData('text/plain', 'row-green');
        });
        return row;
      }

      function setupGrid(startingBlue) {
        grid.innerHTML = '';
        filledCells = startingBlue;
        grid.style.gridTemplateColumns = `repeat(${totalCells / rows}, 80px)`;
        grid.style.gridTemplateRows = `repeat(${rows}, 80px)`;

        for (let i = 0; i < totalCells; i++) {
          const cell = document.createElement('div');
          cell.className = 'cell';
          cell.dataset.index = i;

          cell.addEventListener('dragover', (e) => e.preventDefault());
          cell.addEventListener('drop', (e) => {
            const color = e.dataTransfer.getData('text');

            if (!cell.firstChild) {
              if (color === 'green') {
                const droppedBlock = createBlock('green');
                droppedBlock.draggable = false;
                cell.appendChild(droppedBlock);
                filledCells++;
              }
              if (color === 'row-green') {
                // Fill the whole row
                const rowIndex = Math.floor(i / (totalCells / rows));
                for (let j = 0; j < totalCells / rows; j++) {
                  const index = rowIndex * (totalCells / rows) + j;
                  const targetCell = grid.children[index];
                  if (!targetCell.firstChild) {
                    const b = createBlock('green');
                    b.draggable = false;
                    targetCell.appendChild(b);
                    filledCells++;
                  }
                }
              }
            }
          });

          if (i < startingBlue) {
            const blueBlock = createBlock('blue');
            blueBlock.draggable = false;
            cell.appendChild(blueBlock);
          }

          grid.appendChild(cell);
        }
      }

      function setupPiles(showSingles = true, showRowPile = false) {
  piles.innerHTML = '';

  if (showSingles) {
    const greenPile = document.createElement('div');
    greenPile.className = 'pile';
    greenPile.innerHTML = '<strong>Add Tiles</strong>';
    for (let i = 0; i < 1; i++) {  // You can set this to any fixed number
      greenPile.appendChild(createBlock('green'));
    }
    piles.appendChild(greenPile);
  }

  if (showRowPile) {
    const rowPile = document.createElement('div');
    rowPile.className = 'pile';
    rowPile.innerHTML = '<strong>Add 5 Tiles</strong>';
    rowPile.appendChild(createRowBlock());
    piles.appendChild(rowPile);
  }
}

      function showEquation(startingBlue, total) {
        equation.innerHTML = `${startingBlue} + <input class="answer" id="userAnswer"> = ${total}`;
        const userAnswer = document.getElementById('userAnswer');

        userAnswer.addEventListener('change', () => {
          const value = parseInt(userAnswer.value);
          if (value === total - startingBlue) {
            alert('Correct!');
          } else {
            alert('Try again.');
          }
        });
      }

      function startGame(size) {
  totalCells = size;
  rows = size === 10 ? 2 : 1;
  const startingBlue = Math.floor(Math.random() * size);
  setupGrid(startingBlue);

  if (size === 5) {
    setupPiles(true, false); // Only show single-tile pile
  } else {
    setupPiles(true, true);  // Show both single and row pile
  }

  showEquation(startingBlue, size);
}

      make5Btn.addEventListener('click', () => startGame(5));
      make10Btn.addEventListener('click', () => startGame(10));
    });
  </script>
</body>
</html>

